import{c as I,j as e,S,s as $,V as z,a as A,r as l,P as F,L as k}from"./index-XAQY0n2C.js";import{u as _}from"./useSupabaseQuery-BySWxqua.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=I("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),G=[{id:"550e8400-e29b-41d4-a716-446655440000",name:"Klasyczne Strzyżenie",duration:"45 min",price:70,description:"Profesjonalne strzyżenie z myciem i stylizacją",image:"https://img.freepik.com/premium-photo/barber-works-with-hair-clipper-hipster-client-getting-haircut-hands-barber-with-hair-clipper-close-up_293990-1196.jpg?w=740"},{id:"550e8400-e29b-41d4-a716-446655440001",name:"Przycinanie Brody",duration:"30 min",price:50,description:"Formowanie i stylizacja brody do perfekcji",image:"https://img.freepik.com/free-photo/handsome-man-barbershop-shaving-beard_1303-26258.jpg?t=st=1735601291~exp=1735604891~hmac=fd9cd4bea831dcefbb90538386c46bb0b4af08cb0b52cd26148f50381ed331e5&w=740"},{id:"550e8400-e29b-41d4-a716-446655440002",name:"Golenie na Ciepło",duration:"45 min",price:60,description:"Tradycyjne golenie brzytwą z gorącym ręcznikiem",image:"https://images.unsplash.com/photo-1599351431202-1e0f0137899a?auto=format&fit=crop&q=80"}],K=({service:a,onClick:t})=>e.jsxs("button",{onClick:t,className:"card cursor-pointer overflow-hidden group",children:[e.jsx("div",{className:"h-48 -mx-6 -mt-6 mb-4 overflow-hidden",children:e.jsx("img",{src:a.image,alt:a.name,className:"w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500"})}),e.jsx(S,{className:"w-6 h-6 text-red-500 mb-2"}),e.jsx("h3",{className:"font-bold text-lg",children:a.name}),e.jsx("p",{className:"text-sm text-zinc-400 mb-2",children:a.duration}),e.jsxs("p",{className:"font-bold text-red-500",children:[a.price," PLN"]})]}),M=({barber:a,onClick:t})=>e.jsxs("button",{onClick:t,className:"card cursor-pointer overflow-hidden group",children:[e.jsx("div",{className:"h-48 -mx-6 -mt-6 mb-4 overflow-hidden",children:e.jsx("img",{src:a.image,alt:a.name,className:"w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500"})}),e.jsx(S,{className:"w-6 h-6 text-red-500 mb-2"}),e.jsx("h3",{className:"font-bold text-lg",children:a.name}),e.jsx("p",{className:"text-sm text-zinc-400 mb-2",children:a.location})," ",e.jsx("div",{className:"flex flex-wrap gap-2",children:a.specialties.map((r,n)=>e.jsx("span",{className:"text-xs bg-zinc-800 text-zinc-300 px-2 py-1 rounded-full",children:r},n))})]}),V=({currentStep:a,totalSteps:t})=>e.jsx("div",{className:"flex justify-between items-center max-w-xs mx-auto",children:Array.from({length:t},(r,n)=>n+1).map(r=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${r<=a?"bg-red-600":"bg-zinc-800"}`,children:r}),r<t&&e.jsx("div",{className:`w-12 h-0.5 ${r<a?"bg-red-600":"bg-zinc-800"}`})]},r))}),Q=({slots:a,selectedTime:t,onTimeSelect:r})=>e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2",children:a.map(n=>e.jsx("button",{onClick:()=>r(n),className:`p-2 rounded-lg text-sm font-medium transition-all
            ${t===n?"bg-red-600 text-white":"bg-zinc-800 hover:bg-zinc-700 text-zinc-100"}`,children:n},n))}),Z=({service:a})=>e.jsx("div",{className:"card bg-zinc-900/30",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:a.image,alt:a.name,className:"w-16 h-16 rounded-lg object-cover"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:a.name}),e.jsxs("p",{className:"text-sm text-zinc-400",children:[a.duration," • ",a.price," PLN"]})]})]})}),H=async a=>{try{const{data:t,error:r}=await $.from("bookings").insert([{service_id:a.service_id,barber_id:a.barber_id,customer_name:a.customer_name,customer_email:a.customer_email,customer_phone:a.customer_phone,booking_date:a.booking_date,booking_time:a.booking_time,total_amount:a.total_amount,extras:a.extras_ids||[],status:"pending"}]).select().single();if(r)throw r;return z.success("Rezerwacja została pomyślnie utworzona!"),t}catch(t){throw console.error("Error creating booking:",t),z.error("Wystąpił błąd podczas tworzenia rezerwacji"),t}},J=["10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30"],X=()=>{const a=A(),[t,r]=l.useState(null),[n,P]=l.useState(null),[u,C]=l.useState(""),[h,E]=l.useState(""),[d,L]=l.useState([]),[c,f]=l.useState(1),[p,N]=l.useState(!1),[o,W]=l.useState({customerName:"",customerEmail:"",customerPhone:""}),{data:y}=_("extras",{order:{column:"name",ascending:!0}}),{data:j,loading:B}=_("barbers",{columns:"id, name, image_url, specialties",filters:{active:!0},order:{column:"name",ascending:!0}});l.useEffect(()=>{document.body.classList.add("no-navbar");const s=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);return"serviceWorker"in navigator&&s&&navigator.serviceWorker.register("/sw.js").then(i=>{console.log("Service Worker registered with scope:",i.scope)}).catch(i=>{console.error("Service Worker registration failed:",i)}),()=>document.body.classList.remove("no-navbar")},[]);const x=()=>{c<5&&f(c+1)},b=()=>{c>1&&f(c-1)},T=s=>{L(i=>i.find(m=>m.id===s.id)?i.filter(m=>m.id!==s.id):[...i,s])},v=()=>{let s=t?Number(t.price):0;return d.forEach(i=>{s+=Number(i.price)}),s},q=async s=>{if(s.preventDefault(),!(!t||!n)){N(!0);try{await H({service_id:t.id,barber_id:n.id,customer_name:o.customerName,customer_email:o.customerEmail,customer_phone:o.customerPhone,booking_date:u,booking_time:h,total_amount:v(),extras_ids:d.map(i=>i.id)}),a("/")}catch(i){console.error("Error submitting booking:",i)}finally{N(!1)}}},g=s=>{const{name:i,value:w}=s.target;W(m=>({...m,[i]:w}))};return e.jsx("div",{className:"min-h-screen pt-20 pb-12 bg-gradient-to-b from-black via-zinc-900 to-black",children:e.jsx("div",{className:"container-custom max-w-4xl",children:e.jsxs("div",{className:"space-y-12",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("img",{src:"/logo.png",alt:"Logo",className:"h-24 w-auto mb-6 mx-auto"}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-red-500 to-orange-500",children:"Zarezerwuj swój styl"}),e.jsx("p",{className:"text-zinc-400",children:"Luksusowe doświadczenie w barbershopie w Katowicach"})]}),e.jsx(V,{currentStep:c,totalSteps:5}),e.jsxs("div",{className:"card backdrop-blur-xl",children:[c===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Wybierz usługę"}),e.jsx("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 gap-4",children:G.map(s=>e.jsx(K,{service:s,onClick:()=>{r(s),x()}},s.id))})]}),c===2&&y&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Chcesz dodać coś ekstra?"}),e.jsx("p",{className:"text-zinc-400",children:"Wybierz dodatkowe usługi, aby ulepszyć swoje doświadczenie"}),e.jsx("div",{className:"grid gap-4",children:y.map(s=>e.jsx("div",{className:`p-4 rounded-lg border transition-all cursor-pointer ${d.find(i=>i.id===s.id)?"border-red-500 bg-red-500/10":"border-zinc-800 hover:border-red-500/50"}`,onClick:()=>T(s),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:s.name}),e.jsx("p",{className:"text-sm text-zinc-400",children:s.description})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"font-bold text-red-500",children:[s.price," PLN"]}),d.find(i=>i.id===s.id)?e.jsx(R,{className:"w-5 h-5 text-red-500"}):e.jsx(F,{className:"w-5 h-5 text-zinc-400"})]})]})},s.id))}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx("button",{onClick:b,className:"btn-primary bg-zinc-800",children:"Wstecz"}),e.jsx("button",{onClick:x,className:"btn-primary",children:"Dalej"})]})]}),c===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Wybierz fryzjera"}),B?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(k,{className:"w-8 h-8 animate-spin text-red-500"})}):j&&j.length>0?e.jsx("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 gap-4",children:j.map(s=>e.jsx(M,{barber:{id:s.id,name:s.name,image:s.image_url||"",specialties:s.specialties||[]},onClick:()=>{P(s),x()}},s.id))}):e.jsx("div",{className:"text-center py-12 text-zinc-400",children:"Brak dostępnych barberów"})]}),c===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Wybierz datę i godzinę"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"date",value:u,onChange:s=>C(s.target.value),className:"input-field",required:!0}),e.jsx(Q,{slots:J,selectedTime:h,onTimeSelect:E})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx("button",{onClick:b,className:"btn-primary bg-zinc-800",children:"Wstecz"}),e.jsx("button",{onClick:x,disabled:!u||!h,className:"btn-primary disabled:opacity-50",children:"Dalej"})]})]}),c===5&&e.jsxs("form",{onSubmit:q,className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Twoje dane"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",name:"customerName",value:o.customerName,onChange:g,placeholder:"Imię i nazwisko",className:"input-field",required:!0}),e.jsx("input",{type:"tel",name:"customerPhone",value:o.customerPhone,onChange:g,placeholder:"Telefon",className:"input-field",required:!0}),e.jsx("input",{type:"email",name:"customerEmail",value:o.customerEmail,onChange:g,placeholder:"Email",className:"input-field",required:!0})]}),e.jsxs("div",{className:"mt-8 space-y-4 border-t border-zinc-800 pt-6",children:[e.jsx("h3",{className:"font-semibold",children:"Podsumowanie zamówienia"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:t==null?void 0:t.name}),e.jsxs("span",{children:[t==null?void 0:t.price," PLN"]})]}),d.map(s=>e.jsxs("div",{className:"flex justify-between text-sm text-zinc-400",children:[e.jsx("span",{children:s.name}),e.jsxs("span",{children:[s.price," PLN"]})]},s.id)),e.jsxs("div",{className:"border-t border-zinc-800 pt-2 flex justify-between font-bold",children:[e.jsx("span",{children:"Razem"}),e.jsxs("span",{children:[v()," PLN"]})]})]})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx("button",{type:"button",onClick:b,className:"btn-primary bg-zinc-800",disabled:p,children:"Wstecz"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-5 h-5 animate-spin mr-2"}),"Przetwarzanie..."]}):"Potwierdź rezerwację"})]})]})]}),t&&e.jsx(Z,{service:t})]})})})};export{X as default};
