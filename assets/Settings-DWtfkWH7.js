import{c as S,R as z,r,j as e,L as d,C as H}from"./index-XAQY0n2C.js";import{u as w,a as j}from"./useSupabaseQuery-BySWxqua.js";import{C as L}from"./clock-BK1c9p1T.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=S("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),f=["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota"],E=()=>{const[n,h]=r.useState(""),{data:i,loading:k,refetch:_}=w("working_hours",{order:{column:"day_of_week",ascending:!0},cacheKey:"working-hours"}),{data:l,loading:N,refetch:b}=w("closed_dates",{columns:"id, date",cacheKey:"closed-dates"}),{update:x,loading:u}=j("working_hours",{onSuccess:()=>{_()}}),{create:y,remove:p,loading:m}=j("closed_dates",{onSuccess:()=>{b()}}),c=r.useMemo(()=>i?f.map((a,s)=>i.find(o=>o.day_of_week===s)||{id:`temp-${s}`,day_of_week:s,open_time:"09:00",close_time:"18:00",is_working_day:![0,6].includes(s)}):[],[i]),g=r.useCallback((a,s,t)=>{const o=[...c];o[a]={...o[a],[s]:t}},[c]),v=r.useCallback(async()=>{try{await Promise.all(c.map(a=>x(a.id,{day_of_week:a.day_of_week,open_time:a.open_time,close_time:a.close_time,is_working_day:a.is_working_day})))}catch(a){console.error("Error saving working hours:",a)}},[c,x]),C=r.useCallback(async()=>{if(n)try{await y({date:n}),h("")}catch(a){console.error("Error adding closed date:",a)}},[n,y]),D=r.useCallback(async a=>{try{await p(a)}catch(s){console.error("Error removing closed date:",s)}},[p]);return k&&(!i||i.length===0)?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(d,{className:"w-8 h-8 animate-spin text-gray-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Ustawienia"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Zarządzaj godzinami pracy i dniami zamknięcia"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5 text-gray-500"}),"Godziny Pracy"]}),e.jsx("button",{onClick:v,disabled:u,className:"btn-primary flex items-center gap-2",children:u?e.jsx(d,{className:"w-5 h-5 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"w-5 h-5"}),"Zapisz Zmiany"]})})]}),e.jsx("div",{className:"space-y-4",children:c.map((a,s)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("span",{className:"font-medium",children:f[a.day_of_week]})}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:a.is_working_day,onChange:t=>g(s,"is_working_day",t.target.checked),className:"h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Otwarty"})]}),a.is_working_day&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"time",value:a.open_time,onChange:t=>g(s,"open_time",t.target.value),className:"rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500"}),e.jsx("span",{className:"text-gray-500",children:"do"}),e.jsx("input",{type:"time",value:a.close_time,onChange:t=>g(s,"close_time",t.target.value),className:"rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500"})]})]},a.day_of_week))})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 flex items-center gap-2 mb-6",children:[e.jsx(H,{className:"w-5 h-5 text-gray-500"}),"Dni Zamknięcia"]}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("input",{type:"date",value:n,onChange:a=>h(a.target.value),className:"rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500",min:new Date().toISOString().split("T")[0]}),e.jsx("button",{onClick:C,disabled:!n||m,className:"btn-primary",children:m?e.jsx(d,{className:"w-5 h-5 animate-spin"}):"Dodaj Dzień Zamknięcia"})]}),N?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(d,{className:"w-6 h-6 animate-spin text-gray-400"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l&&l.length>0?l.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-900",children:new Date(a.date).toLocaleDateString("pl",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("button",{onClick:()=>D(a.id),className:"text-red-600 hover:text-red-700",disabled:m,children:"×"})]},a.id)):e.jsx("p",{className:"text-center text-gray-500 col-span-3",children:"Brak zaplanowanych dni zamknięcia"})})]})})]})},M=z.memo(E);export{M as default};
